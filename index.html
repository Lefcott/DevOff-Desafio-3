<html>
  <head>
    <title>DibujadorH1</title>
    <style>
      #picker {
        float: right;
      }
      #clear {
        float: right;
      }
      #download {
        float: right;
      }
      #drawer {
        position: absolute;
      }
    </style>
  </head>
  <canvas
    width="500"
    height="500"
    onmousemove="draw(event)"
    onmouseup="stopDrawing()"
    id="drawer"
  ></canvas>
  <a
    id="download"
    download="myImage.png"
    href=""
    onclick="downloadImage(event);"
    >Descarg&aacute; tu H1!</a
  >
  <br />
  <input type="color" id="picker" onchange="changeColor(event.target.value)" />
  <br />
  <input type="button" value="Borrar" onclick="initCanvas()" id="clear" />
  <body>
    <script>
      const canvas = document.getElementById("drawer");
      const context = canvas.getContext("2d");
      context.lineWidth = 5;
      let lastX = null;
      let lastY = null;

      const draw = (e) => {
        if (!e.buttons) return;
        const x = e.clientX;
        const y = e.clientY;
        if (lastX === null) {
          lastX = x;
          lastY = y;
          return;
        }
        context.beginPath();
        context.moveTo(lastX, lastY);
        context.lineTo(x, y);
        context.stroke();
        lastX = x;
        lastY = y;
      };
      const stopDrawing = () => {
        lastX = null;
        lastY = null;
      };
      const changeColor = (color) => (context.strokeStyle = color);
      const downloadImage = (event) => {
        event.target.href = canvas.toDataURL("image/png");
      };
      const initCanvas = () => {
        context.fillStyle = "#ddd";
        context.fillRect(0, 0, canvas.offsetWidth, canvas.offsetHeight);
      };
      initCanvas();
    </script>
  </body>
</html>
